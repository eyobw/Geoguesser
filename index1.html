<!doctype html>
<html>
	<head>
		<title>Media Project</title>
		<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
		<script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"type="text/javascript"></script>
		<script src="random.js"></script>
	<style type="text/css">
		#map 
		{
		width: 100%;
		height: 400px;
		border: solid;
		}
	</style>
	
	</head>
	<body>
	
		<div id="map" ></div>
		<script>
	function getRandomInRange(from, to, fixed) {
    return (Math.random() * (to - from) + from).toFixed(fixed) * 1;
    // .toFixed() returns string, so ' * 1' is a trick to convert to number
}
	var a = getRandomInRange(-180, 180, 3);
	var b = getRandomInRange(-180, 180, 3);
	var map = L.map('map').setView([a, b], 13);
	
	var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
	var cloudmadeUrl='http://{s}.tile.cloudmade.com/BC9A493B41014CAABB98F0471D759707/997/256/{z}/{x}/{y}.png';

		L.tileLayer(osmUrl, {
			maxZoom: 18
		}).addTo(map);
		
		var marker = L.marker([a,b]).addTo(map);
		
		var circle = L.circle([51.519, -0.09], 500, {
		color: 'yellow',
		fillColor: 'blue',
		fillOpacity: 0.2
		}).addTo(map);
		
		marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();
		circle.bindPopup("I am a circle.");
		
		var popup = L.popup()
    .setLatLng([51.5, -0.09])
    .setContent("I am a standalone popup.")
    .openOn(map);
	
	function onMapClick(e) {
	
	var marker = L.marker(e.latlng).addTo(map);
	//var popup = L.popup().setLatLng([e.latlng]).openOn(map);
    //alert("You clicked the map at " + e.latlng);
	}

	map.on('click', onMapClick);
	
	
	function reloadPage()	{
location.reload();
		//$('#images').load('Service.html #images').fadeIn();
	}
	
	
		
		</script>
		
		
<!-- Codes by HTML.am -->
<div  id="images" width="450" height="450"> 
  <script>
	$(function(){
		//$.getJSON("http://api.flickr.com/services/feeds/photos_public.gne?method=flickr.photos.search&api_key=936c8201f7ef5555a78d0b575ee22f4c&lang=en-us&has_geo=1&extras=geo&format=json&jsoncallback=?", displayImages);
		var apiKey = '936c8201f7ef5555a78d0b575ee22f4c';
		var url = 'http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key=' + apiKey;
		url += '&user_id=84661314@N07&has_geo=1&extras=geo&format=json&jsoncallback=?'
		
		
		var count = 0;								
		var htmlString = "<ul>";
		$.getJSON(url, function(data){
		  if(count <= 10){
			  var ranNum = Math.floor(Math.random()*($(data.photos.photo).size()));
			  console.log("Rand: " + ranNum)
			  //console.log(data)
			  var pic = data.photos.photo[ranNum];
			  console.log(pic)
			  //var img = (pic.media.m);   //.replace("_m.jpg", "_s.jpg");
			  var img = "http://farm" + pic.farm + ".staticflickr.com/" + pic.server + "/" + pic.id + "_" + pic.secret + ".jpg"
			  console.log(img);
			  var picLat = pic.latitude;
			  var picLong = pic.longitude;
			  var link  = pic.link;
			  var title = pic.title;
			  htmlString += '<li><a href="' + link + '" target="_blank">' + ' - WTF??? - ' + pic.longitude + "</a><br>";
				htmlString += '<p><img src="' + img + '" alt="' + title + '" title="' + title + '" width="500" height="500"/>';
				htmlString += '</li>';
				htmlString +='<br/>'+picLat+'</p>'
				count++;
				$('#images').append(htmlString);				
				//displayImages(data);
			}else{
			  htmlString += '</ul>'
			  $('#images').html(htmlString);
			}
			document.writeln(htmlString);
			console.log("wtf: " + htmlString)
		});
	});
  </script>
  </div>
<!--img style="border:1px solid black;" src="http://www.html.am/images/image-codes/milford_sound_t.jpg" width="450" height="450" alt="Photo of Milford Sound in New Zealand" /-->
<button onclick="reloadPage()">Another View</button>
	</body>
	
</html>